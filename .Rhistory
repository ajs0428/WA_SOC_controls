geom_smooth(aes(x = SOC_stock_100, y =PIw$LPB0.025),
data = wa_stocks_wet, method = "lm",
colour = "aquamarine3", se = F, lty = "35", lwd = 1) +
geom_smooth(aes(x = SOC_stock_100, y = fitted(modd1u)),
data = wa_stocks_upl, method = "lm",
colour = "tan2", fill = "tan2", alpha = 0.2,
se = T) +
geom_smooth(aes(x = SOC_stock_100, y = PIu$UPB0.975),
data = wa_stocks_upl, method = "lm",
colour = "tan2", se = F, lty = "35", lwd = 1) +
geom_smooth(aes(x = SOC_stock_100, y =PIu$LPB0.025),
data = wa_stocks_upl, method = "lm",
colour = "tan2", se = F, lty = "35", lwd = 1) +
geom_smooth(aes(x = SOC_stock_100, y = fitted(modd1)),
data = wa_stocks_dat, method = "lm",
colour = "coral3", fill = "coral3", alpha = 0.2,
se = T) +
geom_smooth(aes(x = SOC_stock_100, y = PI$UPB0.975),
data = wa_stocks_dat, method = "lm",
colour = "coral3", se = F, lty = "35", lwd = 1) +
geom_smooth(aes(x = SOC_stock_100, y =PI$LPB0.025),
data = wa_stocks_dat, method = "lm",
colour = "coral3", se = F, lty = "35", lwd = 1) +
geom_abline(slope = 1, intercept = 0, lty = "dotted") +
scale_x_continuous(limits = c(0, 750), expand = c(0, 0)) +
scale_y_continuous(limits = c(0, 750), expand = c(0, 0)) +
ylab(expression('Fitted Model SOC Stock (Mg ha'^-1*')')) +
xlab(expression('Actual SOC Stock (Mg ha'^-1*')')) +
theme(
panel.background = element_blank(),
panel.grid.major = element_line(colour = "grey80"),
axis.ticks = element_blank()
)
all_1m_plot <- ggplot() +
geom_point(aes(x = SOC_stock_100, y = fitted(modd1w)),
data = wa_stocks_wet, colour = "aquamarine3", size = 2) +
geom_point(aes(x = SOC_stock_100, y = fitted(modd1u)),
data = wa_stocks_upl, colour = "tan", size = 2) +
geom_smooth(aes(x = SOC_stock_100, y = fitted(modd1w)),
data = wa_stocks_wet, method = "lm",
colour = "aquamarine3", fill = "aquamarine3", alpha = 0.2,
se = T) +
geom_smooth(aes(x = SOC_stock_100, y = PIw$UPB0.975),
data = wa_stocks_wet, method = "lm",
colour = "aquamarine3", se = F, lty = "35", lwd = 1) +
geom_smooth(aes(x = SOC_stock_100, y =PIw$LPB0.025),
data = wa_stocks_wet, method = "lm",
colour = "aquamarine3", se = F, lty = "35", lwd = 1) +
geom_smooth(aes(x = SOC_stock_100, y = fitted(modd1u)),
data = wa_stocks_upl, method = "lm",
colour = "tan2", fill = "tan2", alpha = 0.2,
se = T) +
geom_smooth(aes(x = SOC_stock_100, y = PIu$UPB0.975),
data = wa_stocks_upl, method = "lm",
colour = "tan2", se = F, lty = "35", lwd = 1) +
geom_smooth(aes(x = SOC_stock_100, y =PIu$LPB0.025),
data = wa_stocks_upl, method = "lm",
colour = "tan2", se = F, lty = "35", lwd = 1) +
geom_smooth(aes(x = SOC_stock_100, y = fitted(modd1)),
data = wa_stocks_dat, method = "lm",
colour = "coral3", fill = "coral3", alpha = 0.2,
se = T) +
geom_smooth(aes(x = SOC_stock_100, y = PI$UPB0.975),
data = wa_stocks_dat, method = "lm",
colour = "coral3", se = F, lty = "35", lwd = 1) +
geom_smooth(aes(x = SOC_stock_100, y =PI$LPB0.025),
data = wa_stocks_dat, method = "lm",
colour = "coral3", se = F, lty = "35", lwd = 1) +
geom_abline(slope = 1, intercept = 0, lty = "dotted") +
scale_x_continuous(limits = c(0, 750), expand = c(0, 0)) +
scale_y_continuous(limits = c(0, 750), expand = c(0, 0)) +
ylab(expression('Fitted Model SOC Stock (Mg ha'^-1*')')) +
xlab(expression('Actual SOC Stock (Mg ha'^-1*')')) +
theme(
panel.background = element_blank(),
panel.grid.major = element_line(colour = "grey80"),
axis.ticks = element_blank()
)
save(all_1m_plot, file = "SOIL CARBON/All_WA/writing/Figures/Aggregate_1m_SOC_All_Models.RData")
all_1m_plot <- get(load("SOIL CARBON/All_WA/writing/Figures/Aggregate_1m_SOC_All_Models.RData"))
"SOIL CARBON/All_WA/writing/Figures/Aggregate_1m_SOC_All_Models.RData"
"SOIL CARBON/All_WA/writing/Figures/Aggregate_1m_SOC_All_Models.RData"
"SOIL CARBON/All_WA/writing/Figures/Aggregate_1m_SOC_All_Models.RData"
all_1m_plot <- get(("SOIL CARBON/All_WA/writing/Figures/Aggregate_1m_SOC_All_Models.RData"))
all_1m_plot <- get(load("SOIL CARBON/All_WA/writing/Figures/Aggregate_1m_SOC_All_Models.RData"))
all_1m_plot <- get(load("/Users/Anthony/OneDrive - UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/writing/Figures/Aggregate_1m_SOC_All_Models.RData"))
"SOIL CARBON/All_WA/writing/Figures/Aggregate_1m_SOC_All_Models.RData"
all_1m_plot <- get(load("/Users/Anthony/OneDrive - UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/writing/Figures/Aggregate_1m_SOC_All_Models.RData"))
all_1m_plot
#| message: false
all_1m_plot <- get(load("/Users/Anthony/OneDrive - UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/writing/Figures/Aggregate_1m_SOC_All_Models.RData"))
all_1m_plot
#| message: false
#| warning: false
all_1m_plot <- get(load("/Users/Anthony/OneDrive - UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/writing/Figures/Aggregate_1m_SOC_All_Models.RData"))
all_1m_plot
#| include: true
#| label: tbl-varsite
#| tbl-cap: "SOC stock mean and variation across depths within each watershed study area"
wa_dat |> group_by(site, lower_depth) |> summarise(mean = mean(SOC_stock_spline),
sd = sd(SOC_stock_spline),
n = n()) |>
mutate(se = sd/sqrt(n)) |> kbl() |> kable_classic_2("hover", full_width = F)
#| label: tbl-1mSOC
#| tbl-cap: "1m SOC stock mean and variation within each watershed study area"
wa_stocks_dat |>
group_by(site) |> summarise(mean = mean(SOC_stock_100),
sd = sd(SOC_stock_100),
n = n()) |>
mutate(se = sd/sqrt(n)) |> kbl() |> kable_classic_2("hover", full_width = F)
wa_stocks_dat |>
mutate(wetupl = case_when(WIP >= 0.5 ~ "WET",
.default = "UPL")) |>
group_by(site, wetupl) |> summarise(mean = mean(SOC_stock_100),
sd = sd(SOC_stock_100),
n = n()) |>
mutate(se = sd/sqrt(n)) |> kbl() |> kable_classic_2("hover", full_width = F)
View(wa_stocks_scale)
#| include: false
r2glmm::r2beta(mod7, partial = F, method = "nsj")
MuMIn::r.squaredGLMM(mod7)
sjPlot::tab_model(mod7)
ggplot() +
geom_point(aes(x = SOC_stock_100, y = fitted(modd1w)),
data = wa_stocks_wet, colour = "aquamarine3") +
geom_point(aes(x = SOC_stock_100, y = fitted(modd1u)),
data = wa_stocks_upl, colour = "tan") +
geom_smooth(aes(x = SOC_stock_100, y = fitted(modd1w)),
data = wa_stocks_wet, method = "lm", colour = "aquamarine3", se = F) +
geom_smooth(aes(x = SOC_stock_100, y = fitted(modd1u)),
data = wa_stocks_upl, method = "lm", colour = "tan", se = F) +
geom_smooth(aes(x = SOC_stock_100, y = fitted(modd1)),
data = wa_stocks_dat, method = "lm", se = F) +
geom_abline(slope = 1, intercept = 0) +
ylim(0, 700) +
xlim(0,700)
#| include: false
r2glmm::r2beta(mod7, partial = F, method = "nsj")
MuMIn::r.squaredGLMM(mod7)
sjPlot::tab_model(mod7)
r2partial <- r2glmm::r2beta(mod7d1, data = wa_dat_scale, method = "nsj") |> data.frame()
readr::write_csv(r2partial, "SOIL CARBON/All_WA/data/dataframes/mod7d1_r2partial.csv")
r2partialw <- r2glmm::r2beta(modw, data = wa_dat_scale_wet, method = "nsj") |> data.frame()
r2partialu <- r2glmm::r2beta(modu, data = wa_dat_scale_upl, method = "nsj") |> data.frame()
r2partial
r2partialw
r2partialu
save(mod7d1, file = "SOIL CARBON/All_WA/analysis/models/All_WA_Model7d1_Spline.RData")
save(modw, file = "SOIL CARBON/All_WA/analysis/models/All_WA_Model_Wet_Spline.RData")
save(modu, file = "SOIL CARBON/All_WA/analysis/models/All_WA_Model_Upl_Spline.RData")
PI <- predictInterval(
mod7d1,
which = c("full"),
level = 0.95,
n.sims = 1000,
stat = c("median"),
type = c("linear.prediction"),
include.resid.var = TRUE,
returnSims = TRUE,
seed = 11
)
PIw <- predictInterval(
modw,
which = c("full"),
level = 0.95,
n.sims = 1000,
stat = c("median"),
type = c("linear.prediction"),
include.resid.var = TRUE,
returnSims = TRUE,
seed = 11
)
PIu <- predictInterval(
modu,
which = c("full"),
level = 0.95,
n.sims = 1000,
stat = c("median"),
type = c("linear.prediction"),
include.resid.var = TRUE,
returnSims = TRUE,
seed = 11
)
PI_trans <- PI |> mutate(fit_t = 10**(fit),
upr_t = 10**(upr),
lwr_t = 10**(lwr),
act = wa_dat_scale$SOC_stock_spline,
fit_t_act = 10**(fit_t - act))
PIw_trans <- PIw |> mutate(fit_t = 10**(fit),
upr_t = 10**(upr),
lwr_t = 10**(lwr),
act = wa_dat_scale_wet$SOC_stock_spline,
fit_t_act = 10**(fit_t - act))
PIu_trans <- PIu |> mutate(fit_t = 10**(fit),
upr_t = 10**(upr),
lwr_t = 10**(lwr),
act = wa_dat_scale_upl$SOC_stock_spline,
fit_t_act = 10**(fit_t - act))
PI_rmse <- sqrt(abs(sum(PI_trans$fit_t - PI_trans$act)**2)/nrow(wa_dat_scale))
PI_rmse
PIw_rmse <- sqrt(abs(sum(PIw_trans$fit_t - PIw_trans$act)**2)/nrow(wa_dat_scale_wet))
PIw_rmse
PIu_rmse <- sqrt(abs(sum(PIu_trans$fit_t - PIu_trans$act)**2)/nrow(wa_dat_scale_upl))
PIu_rmse
# knitr::purl("/Users/Anthony/OneDrive - UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/analysis/WA_SOC_controls/All_WA_SOC_Modeling_Analysis.Rmd", output = "/Users/Anthony/OneDrive - UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/analysis/WA_SOC_controls/All_WA_SOC_Modeling_Analysis.R")
#
# source("/Users/Anthony/OneDrive - UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/analysis/WA_SOC_controls/All_WA_SOC_Modeling_Analysis.R")
# knitr::purl("~/Library/CloudStorage/OneDrive-UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/writing/FiguresTables.qmd", output = "~/Library/CloudStorage/OneDrive-UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/writing/FiguresTables.R")
#
# source("~/Library/CloudStorage/OneDrive-UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/writing/FiguresTables.R")
source("/Users/Anthony/OneDrive - UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/analysis/All_WA_Functions.R")
wa_dat <- read.csv("/Users/Anthony/OneDrive - UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/data/dataframes/All_WA_SOC_ExtractPreds.csv")
wa_stocks_dat <- read.csv("/Users/Anthony/OneDrive - UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/data/dataframes/All_WA_1m_stocks_preds.csv")
wa_dat_scale <- read.csv("/Users/Anthony/OneDrive - UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/data/dataframes/All_WA_SOC_ExtractPreds_Scaled.csv")
mod7 <- get(load("/Users/Anthony/OneDrive - UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/analysis/models/All_WA_Model7d1_Spline.RData"))
#| include: false
r2glmm::r2beta(mod7, partial = F, method = "nsj")
MuMIn::r.squaredGLMM(mod7)
sjPlot::tab_model(mod7)
save(modu, file = "SOIL CARBON/All_WA/analysis/models/All_WA_Model_Upl_Spline.RData")
#| include: false
r2glmm::r2beta(mod7, partial = F, method = "nsj")
MuMIn::r.squaredGLMM(mod7)[[1]]
#sjPlot::tab_model(mod7)
#| include: false
r2glmm_r2 <- r2glmm::r2beta(mod7, partial = F, method = "nsj")
mumin_R2 <- MuMIn::r.squaredGLMM(mod7)[[1]]
#sjPlot::tab_model(mod7)
paste(round(mumin_R2, 2))
library(webshot2)
#| include: false
library(formatR)
knitr::opts_chunk$set(echo = FALSE, fig.align = "center", fig.show = "hold", warning = FALSE,
message = FALSE, dpi = 100, tidy.opts = list(width.cutoff = 60), tidy = T, collapse = TRUE, root.dir = '/Users/Anthony/OneDrive - UW/University of Washington/Data and Modeling/')
library(rgl)
library(terra)
library(lme4)
library(MASS)
library(mgcv)
library(lmerTest)
library(MuMIn)
library(RLRsim)
library(terra)
library(spatialEco)
library(sf)
library(mapview)
library(car)
library(ggplot2)
library(forcats)
library(sjPlot)
library(sjstats)
library(DHARMa)
library(ggeffects)
library(merTools)
library(glmnet)
library(stats)
library(ggcorrplot)
library(RColorBrewer)
library(cowplot)
library(webshot)
library(webshot2)
library(kableExtra)
library(pdp)
library(vip)
library(formatR)
library(dplyr)
library(ggpubr)
library(grid)
library(gridExtra)
library(flextable)
library(gtsummary)
library(stringr)
library(effectsize)
library(officer)
knitr::knit_hooks$set(webgl = hook_webgl)
rgl::setupKnitr(autoprint = TRUE)
#| include: true
#| label: tbl-varsite
#| tbl-cap: "SOC stock mean and variation across depths within each watershed study area"
wa_dat |> group_by(site, lower_depth) |> summarise(mean = mean(SOC_stock_spline),
sd = sd(SOC_stock_spline),
n = n()) |>
mutate(se = sd/sqrt(n)) |> kbl() |>
flextable_fun()
#| include: true
#| label: tbl-varsite
#| tbl-cap: "SOC stock mean and variation across depths within each watershed study area"
wa_dat |> group_by(site, lower_depth) |> summarise(mean = mean(SOC_stock_spline),
sd = sd(SOC_stock_spline),
n = n()) |>
mutate(se = sd/sqrt(n)) |> kbl() |>
flextable_fun()
coords_mas <- sf::st_coordinates(mas_st)/1000
#| include: true
#| label: tbl-varsite
#| tbl-cap: "SOC stock mean and variation across depths within each watershed study area"
wa_dat |> group_by(site, lower_depth) |> summarise(mean = mean(SOC_stock_spline),
sd = sd(SOC_stock_spline),
n = n()) |>
mutate(se = sd/sqrt(n)) |> kbl() |> as.data.frame() |>
flextable_fun()
#| include: true
#| label: tbl-varsite
#| tbl-cap: "SOC stock mean and variation across depths within each watershed study area"
wa_dat |> group_by(site, lower_depth) |> summarise(mean = mean(SOC_stock_spline),
sd = sd(SOC_stock_spline),
n = n()) |>
mutate(se = sd/sqrt(n)) |>
flextable_fun()
#| label: tbl-1mSOC
#| tbl-cap: "1m SOC stock mean and variation within each watershed study area"
wa_stocks_dat |>
group_by(site) |> summarise(mean = mean(SOC_stock_100),
sd = sd(SOC_stock_100),
n = n()) |>
mutate(se = sd/sqrt(n)) |>
flextable_fun()
wa_stocks_dat |>
mutate(wetupl = case_when(WIP >= 0.5 ~ "WET",
.default = "UPL")) |>
group_by(site, wetupl) |> summarise(mean = mean(SOC_stock_100),
sd = sd(SOC_stock_100),
n = n()) |>
mutate(se = sd/sqrt(n)) |>
flextable_fun()
MuMIn::r.squaredGLMM(mod7)
mumin_R2c <- MuMIn::r.squaredGLMM(mod7)[[2]]
round(r.sq(log10(wa_dat_scale$SOC_stock_spline), fitted(mod7d1)), 3)
round(r.sq(log10(wa_dat_scale_wet$SOC_stock_spline), fitted(modw)), 3)
round(r.sq(log10(wa_dat_scale_upl$SOC_stock_spline), fitted(modu)), 3)
r2partial <- r2glmm::r2beta(mod7d1, data = wa_dat_scale, method = "nsj") |> data.frame()
wa_dat_scale_wet
library(formatR)
knitr::opts_chunk$set(echo = FALSE, fig.align = "center", fig.show = "hold", time_it = TRUE, dpi = 100, message = FALSE, warning = FALSE, results = "hide")
knitr::opts_chunk$set(tidy.opts = list(width.cutoff = 60), tidy = T, collapse = TRUE)
knitr::opts_knit$set(root.dir = '/Users/Anthony/OneDrive - UW/University of Washington/Data and Modeling/')
library(rgl)
library(terra)
library(lme4)
library(MASS)
library(mgcv)
library(lmerTest)
library(MuMIn)
library(RLRsim)
library(terra)
library(spatialEco)
library(sf)
library(mapview)
library(car)
library(ggplot2)
library(forcats)
library(sjPlot)
library(sjstats)
library(DHARMa)
library(ggeffects)
library(merTools)
library(glmnet)
library(stats)
library(ggcorrplot)
library(RColorBrewer)
library(cowplot)
library(patchwork)
library(webshot)
library(webshot2)
library(kableExtra)
library(pdp)
library(vip)
library(formatR)
library(dplyr)
library(ggpubr)
library(grid)
library(gridExtra)
library(ppcor)
knitr::knit_hooks$set(webgl = hook_webgl)
rgl::setupKnitr(autoprint = TRUE)
# Quick R^2 function
r.sq <- function(y,y.fitted){
res <- y-y.fitted
1-sum(res^2)/sum((y-mean(y))^2)
}
hoh_dat <- data.frame(vect("SOIL CARBON/All_WA/data/points/hoh_pts_2855.gpkg"))
mas_dat <- data.frame(vect("SOIL CARBON/All_WA/data/points/mas_pts_2856.gpkg"))
col_dat <- data.frame(vect("SOIL CARBON/All_WA/data/points/col_pts_2855.gpkg"))
wa_dat <- rbind(hoh_dat, mas_dat, col_dat) |>
filter(lower_depth <=200) |>
rename(EVT = names) |>
mutate(
sample_ID = as.factor(sample_ID),
GEO = as.factor(GEO),
EVT = as.factor(EVT),
geomorphons = as.factor(geomorphons),
site = as.factor(site),
site = fct_reorder(site, SOC_stock_spline, .fun = "median")) |>
dplyr::rename_with(~gsub("_median", "", .x, fixed = TRUE))
wa_dat
readr::write_csv(wa_dat,"SOIL CARBON/All_WA/data/dataframes/All_WA_SOC_ExtractPreds.csv")
unique(hoh_dat$GEO)
unique(mas_dat$GEO)
unique(col_dat$GEO)
wa_dat_num <- wa_dat |>
dplyr::select(SOC_stock_spline,
lower_depth,
CHM,
MAT,
MAP,
VPD,
DTM,
HLI,
NDYI, # Normalized difference yellow index
NDVI, # Normalized difference vegetation index
MNDWI, #Modified Normalized Difference Water Index
EVI, # Enhanced vegetation index
WIP) |> as.matrix()
corplot <- ggcorrplot(cor(wa_dat_num), method = "square", type = "full", lab = T, lab_size = 3)
corplot
wa_dat_num_topo <- wa_dat |> dplyr::select(SOC_stock_spline,
dev_1000, dev_300, dev_50,
grad_1000, grad_300, grad_50,
WIP, DTM) |> as.matrix()
corplot_topo <- ggcorrplot(cor(wa_dat_num_topo), method = "square", type = "full", lab = T, lab_size = 3)
corplot_topo
columns_to_exclude <- c("SOC_stock_spline")
wa_dat_scale <- wa_dat |>
dplyr::select(sample_ID, lower_depth, SOC_stock_spline,
site, CHM, DTM, geomorphons, GEO, WIP, EVT,
EVI, NDVI, NDYI, VPD, dev_1000, grad_1000, dev_50, grad_300, grad_50,
MNDWI, HLI, lower_depth, MAT, MAP) |>
dplyr::mutate(across(
dplyr::where(is.numeric) & !all_of(columns_to_exclude),
~dplyr::case_when(TRUE ~ scale(.))),
site = fct_reorder(site, SOC_stock_spline, .fun = "median"))
write_csv(wa_dat_scale, file = "SOIL CARBON/All_WA/data/dataframes/All_WA_SOC_ExtractPreds_Scaled.csv")
hist(wa_dat_scale$SOC_stock_spline)
hist(log10(wa_dat_scale$SOC_stock_spline))
wa_dat_scale_wet <- wa_dat |>
filter(WIP >= 0.50) |>
dplyr::select(sample_ID, lower_depth, SOC_stock_spline,
site, CHM, DTM, geomorphons, GEO, WIP, EVT,
EVI, NDVI, NDYI, VPD, dev_1000, grad_1000, dev_50, grad_300, grad_50,
MNDWI, HLI, lower_depth, MAT, MAP) |>
dplyr::mutate(across(
dplyr::where(is.numeric) & !all_of(columns_to_exclude),
~dplyr::case_when(TRUE ~ scale(.))),
site = fct_reorder(site, SOC_stock_spline, .fun = "median"))
write_csv(wa_dat_scale_wet, file = "SOIL CARBON/All_WA/data/dataframes/All_WA_SOC_ExtractPreds_Scaled_Wet.csv")
wa_dat_scale_upl <- wa_dat |>
filter(WIP < 0.50) |>
dplyr::select(sample_ID, lower_depth, SOC_stock_spline,
site, CHM, DTM, geomorphons, GEO, WIP, EVT,
EVI, NDVI, NDYI, VPD, dev_1000, grad_1000, dev_50, grad_300, grad_50,
MNDWI, HLI, lower_depth, MAT, MAP) |>
dplyr::mutate(across(
dplyr::where(is.numeric) & !all_of(columns_to_exclude),
~dplyr::case_when(TRUE ~ scale(.))),
site = fct_reorder(site, SOC_stock_spline, .fun = "median"))
write_csv(wa_dat_scale_upl, file = "SOIL CARBON/All_WA/data/dataframes/All_WA_SOC_ExtractPreds_Scaled_Upl.csv")
wa_dat_scale
write_csv(data.frame(wa_dat_scale), file = "SOIL CARBON/All_WA/data/dataframes/All_WA_SOC_ExtractPreds_Scaled.csv")
write_csv(as.data.frame(wa_dat_scale), file = "SOIL CARBON/All_WA/data/dataframes/All_WA_SOC_ExtractPreds_Scaled.csv")
readr::write_csv(wa_dat_scale, file = "SOIL CARBON/All_WA/data/dataframes/All_WA_SOC_ExtractPreds_Scaled.csv")
?write_csv
write.csv(wa_dat_scale, file = "SOIL CARBON/All_WA/data/dataframes/All_WA_SOC_ExtractPreds_Scaled.csv")
columns_to_exclude <- c("SOC_stock_spline")
wa_dat_scale <- wa_dat |>
dplyr::select(sample_ID, lower_depth, SOC_stock_spline,
site, CHM, DTM, geomorphons, GEO, WIP, EVT,
EVI, NDVI, NDYI, VPD, dev_1000, grad_1000, dev_50, grad_300, grad_50,
MNDWI, HLI, lower_depth, MAT, MAP) |>
dplyr::mutate(across(
dplyr::where(is.numeric) & !all_of(columns_to_exclude),
~dplyr::case_when(TRUE ~ scale(.))),
site = fct_reorder(site, SOC_stock_spline, .fun = "median"))
write.csv(wa_dat_scale, file = "SOIL CARBON/All_WA/data/dataframes/All_WA_SOC_ExtractPreds_Scaled.csv")
hist(wa_dat_scale$SOC_stock_spline)
hist(log10(wa_dat_scale$SOC_stock_spline))
wa_dat_scale_wet <- wa_dat |>
filter(WIP >= 0.50) |>
dplyr::select(sample_ID, lower_depth, SOC_stock_spline,
site, CHM, DTM, geomorphons, GEO, WIP, EVT,
EVI, NDVI, NDYI, VPD, dev_1000, grad_1000, dev_50, grad_300, grad_50,
MNDWI, HLI, lower_depth, MAT, MAP) |>
dplyr::mutate(across(
dplyr::where(is.numeric) & !all_of(columns_to_exclude),
~dplyr::case_when(TRUE ~ scale(.))),
site = fct_reorder(site, SOC_stock_spline, .fun = "median"))
write.csv(wa_dat_scale_wet, file = "SOIL CARBON/All_WA/data/dataframes/All_WA_SOC_ExtractPreds_Scaled_Wet.csv")
wa_dat_scale_upl <- wa_dat |>
filter(WIP < 0.50) |>
dplyr::select(sample_ID, lower_depth, SOC_stock_spline,
site, CHM, DTM, geomorphons, GEO, WIP, EVT,
EVI, NDVI, NDYI, VPD, dev_1000, grad_1000, dev_50, grad_300, grad_50,
MNDWI, HLI, lower_depth, MAT, MAP) |>
dplyr::mutate(across(
dplyr::where(is.numeric) & !all_of(columns_to_exclude),
~dplyr::case_when(TRUE ~ scale(.))),
site = fct_reorder(site, SOC_stock_spline, .fun = "median"))
write.csv(wa_dat_scale_upl, file = "SOIL CARBON/All_WA/data/dataframes/All_WA_SOC_ExtractPreds_Scaled_Upl.csv")
# knitr::purl("/Users/Anthony/OneDrive - UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/analysis/WA_SOC_controls/All_WA_SOC_Modeling_Analysis.Rmd", output = "/Users/Anthony/OneDrive - UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/analysis/WA_SOC_controls/All_WA_SOC_Modeling_Analysis.R")
#
# source("/Users/Anthony/OneDrive - UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/analysis/WA_SOC_controls/All_WA_SOC_Modeling_Analysis.R")
# knitr::purl("~/Library/CloudStorage/OneDrive-UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/writing/FiguresTables.qmd", output = "~/Library/CloudStorage/OneDrive-UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/writing/FiguresTables.R")
#
# source("~/Library/CloudStorage/OneDrive-UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/writing/FiguresTables.R")
source("/Users/Anthony/OneDrive - UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/analysis/All_WA_Functions.R")
wa_dat <- read.csv("/Users/Anthony/OneDrive - UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/data/dataframes/All_WA_SOC_ExtractPreds.csv")
wa_stocks_dat <- read.csv("/Users/Anthony/OneDrive - UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/data/dataframes/All_WA_1m_stocks_preds.csv")
wa_dat_scale <- read.csv("/Users/Anthony/OneDrive - UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/data/dataframes/All_WA_SOC_ExtractPreds_Scaled.csv")
wa_dat_scale_wet <- read.csv("/Users/Anthony/OneDrive - UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/data/dataframes/All_WA_SOC_ExtractPreds_Scaled_Wet.csv")
wa_dat_scale_upl <- read.csv("/Users/Anthony/OneDrive - UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/data/dataframes/All_WA_SOC_ExtractPreds_Scaled_Upl.csv")
mod7 <- get(load("/Users/Anthony/OneDrive - UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/analysis/models/All_WA_Model7d1_Spline.RData"))
modw <- get(load("/Users/Anthony/OneDrive - UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/analysis/models/All_WA_Model_Wet_Spline.RData"))
modu <- get(load("/Users/Anthony/OneDrive - UW/University of Washington/Data and Modeling/SOIL CARBON/All_WA/analysis/models/All_WA_Model_Upl_Spline.RData"))
